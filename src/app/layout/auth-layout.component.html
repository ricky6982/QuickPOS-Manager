<div class="layout-container">
  <mat-toolbar color="primary">
    <div class="toolbar-left">
      <img src="/logo.svg" alt="logo" class="logo" />
      <span class="apptitle">{{ title() }}</span>
    </div>

    <div class="toolbar-right">
      <!-- Selector de Organizadores -->
      <mat-form-field appearance="outline" subscriptSizing="dynamic" class="organizer-selector">
        <mat-select
          [value]="selectedOrganizer()"
          (selectionChange)="onOrganizerChange($event.value)">

          <!-- Opción en blanco para deseleccionar -->
          <mat-option [value]="null">
            <em>-- Ninguno --</em>
          </mat-option>

          <!-- Buscador (solo si hay más de 10 organizadores) -->
          @if (showSearch()) {
            <mat-option>
              <ngx-mat-select-search
                [formControl]="organizerSearchCtrl"
                placeholderLabel="Buscar ..."
                noEntriesFoundLabel="No se encontraron organizadores">
              </ngx-mat-select-search>
            </mat-option>
          }

          <!-- Lista de organizadores filtrados -->
          @for (organizer of filteredOrganizers(); track organizer.id) {
            <mat-option [value]="organizer.id">
              {{ organizer.name }}
            </mat-option>
          }
        </mat-select>
      </mat-form-field>

      <!-- Menú de Usuario -->
      @if (username()) {
        <button mat-button [matMenuTriggerFor]="userMenu" class="user-menu-button">
          <mat-icon>account_circle</mat-icon>
          <span>{{ username() }}</span>
          <mat-icon>arrow_drop_down</mat-icon>
        </button>
        <mat-menu #userMenu="matMenu">
          <button mat-menu-item disabled>
            <mat-icon>person</mat-icon>
            <span>{{ username() }}</span>
          </button>
          <mat-divider></mat-divider>
          <button mat-menu-item (click)="logout()">
            <mat-icon>logout</mat-icon>
            <span>Cerrar sesión</span>
          </button>
        </mat-menu>
      }
    </div>
  </mat-toolbar>

  <mat-sidenav-container class="sidenav-container">
    <mat-sidenav mode="side" opened class="sidenav">
      <mat-nav-list>
        <a mat-list-item routerLink="/users" routerLinkActive="active">Usuarios</a>
        <a mat-list-item routerLink="/organizers" routerLinkActive="active">Organizadores</a>
        <a mat-list-item routerLink="/categories" routerLinkActive="active">Categorías</a>
        <a mat-list-item routerLink="/products" routerLinkActive="active">Productos</a>
        <a mat-list-item routerLink="/price-lists" routerLinkActive="active">Lista de Precios</a>
      </mat-nav-list>
    </mat-sidenav>

    <mat-sidenav-content>
      <div class="content">
        <router-outlet></router-outlet>
      </div>
    </mat-sidenav-content>
  </mat-sidenav-container>
</div>

