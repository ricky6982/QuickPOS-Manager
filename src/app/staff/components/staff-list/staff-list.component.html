<div class="staff-list-container">
  <div class="header">
    <h1>Personal</h1>
    <button mat-raised-button color="primary" (click)="openAddStaffModal()">
      <mat-icon>person_add</mat-icon>
      Agregar Usuario
    </button>
  </div>

  @if (loading()) {
    <div class="loading-container">
      <mat-spinner></mat-spinner>
    </div>
  } @else {
    <div class="table-container">
      <table mat-table [dataSource]="staff()" class="mat-elevation-z2">
        <!-- Nombre Column -->
        <ng-container matColumnDef="firstName">
          <th mat-header-cell *matHeaderCellDef>Nombre</th>
          <td mat-cell *matCellDef="let element">{{ element.firstName }}</td>
        </ng-container>

        <!-- Apellido Column -->
        <ng-container matColumnDef="lastName">
          <th mat-header-cell *matHeaderCellDef>Apellido</th>
          <td mat-cell *matCellDef="let element">{{ element.lastName }}</td>
        </ng-container>

        <!-- Email Column -->
        <ng-container matColumnDef="email">
          <th mat-header-cell *matHeaderCellDef>Email</th>
          <td mat-cell *matCellDef="let element">{{ element.email }}</td>
        </ng-container>

        <!-- Role Column -->
        <ng-container matColumnDef="roles">
          <th mat-header-cell *matHeaderCellDef>Roles</th>
          <td mat-cell *matCellDef="let element">{{ element.roles }}</td>
        </ng-container>

        <!-- Status Column -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Estado</th>
          <td mat-cell *matCellDef="let element">
            <mat-chip-option
              [selected]="true"
              [color]="getStatusColor(element.status)">
              {{ getStatusLabel(element.status) }}
            </mat-chip-option>
          </td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Acciones</th>
          <td mat-cell *matCellDef="let element">
            <div class="actions-container">
              <button
                mat-icon-button
                color="primary"
                (click)="editStaff(element)"
                matTooltip="Editar Permisos">
                <mat-icon>edit</mat-icon>
              </button>

              @if (element.status === 0) {
                <button
                  mat-icon-button
                  color="warn"
                  (click)="toggleStatus(element)"
                  matTooltip="Suspender">
                  <mat-icon>block</mat-icon>
                </button>
              } @else {
                <button
                  mat-icon-button
                  color="accent"
                  (click)="toggleStatus(element)"
                  matTooltip="Activar">
                  <mat-icon>check_circle</mat-icon>
                </button>
              }
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>

      @if (staff().length === 0) {
        <div class="empty-state">
          <mat-icon>people_outline</mat-icon>
          <p>No hay personal registrado</p>
        </div>
      }
    </div>

    <app-pagination
      [currentPage]="currentPage()"
      [pageSize]="pageSize()"
      [totalItems]="totalItems()"
      (pageChange)="onPageChange($event)"
      (pageSizeChange)="onPageSizeChange($event)">
    </app-pagination>
  }
</div>
